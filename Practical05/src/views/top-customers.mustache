<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Top Customers</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  {{>partials/nav}}

  <main class="container py-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h1 class="h4 mb-0">
        {{#usingMv}}MV{{/usingMv}}{{^usingMv}}Live JOIN{{/usingMv}} â€” Top customers for {{month}}
      </h1>
      <a class="btn btn-outline-secondary" href="/?role={{role}}">Back</a>
    </div>

    <div class="alert alert-primary">
      Execution time (app measured): <strong>{{runtimeMs}} ms</strong>
    </div>

    {{^results}}
      <div class="alert alert-warning">
        No rows returned. (Either DB is empty, or there were no orders in that month.)
      </div>
    {{/results}}

    <table class="table table-striped table-bordered bg-white">
      <thead>
        <tr>
          <th>customer_id</th>
          <th>customer_name</th>
          <th class="text-end">total_spent</th>
        </tr>
      </thead>
      <tbody>
        {{#results}}
        <tr>
          <td>{{customer_id}}</td>
          <td>{{customer_name}}</td>
          <td class="text-end">{{total_spent}}</td>
        </tr>
        {{/results}}
      </tbody>
    </table>

    {{#planJson}}
    <h2 class="h6 mt-4">EXPLAIN / EXPLAIN ANALYZE output</h2>
    <pre class="bg-white p-3 border rounded small">{{planJson}}</pre>
    {{/planJson}}
  </main>
</body>
</html>

